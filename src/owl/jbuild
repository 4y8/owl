(jbuild_version 1)

(copy_files# maths/*)
(copy_files# maths/cdflib/*)
(copy_files# maths/cephes/*)
(copy_files# stats/*)
(copy_files# stats/sfmt/*)
(copy_files# neural/*)

(library (
  (name owl)
  (public_name owl)
  (wrapped false)
  (c_names (
    owl_common_c
    owl_stats_ziggurat
    owl_stats_distribution
    owl_distribution_common_c
    owl_dense_common_c
    owl_dense_common_cmp
    owl_dense_common_map
    owl_dense_common_fold
    owl_cblas_generated_stub
    owl_lapacke_generated_stub
    SFMT
    ; CDFlib
    dcdflib
    ipmpar
    ; Cephes
    sf_error
    airy
    bdtr
    beta
    btdtr
    cbrt
    chbevl
    chdtr
    const
    dawsn
    ellie
    ellik
    ellpe
    ellpj
    ellpk
    exp10
    exp2
    expn
    fdtr
    fresnl
    gamma
    gdtr
    gels
    hyp2f1
    hyperg
    i0
    i1
    igam
    igami
    incbet
    incbi
    j0
    j1
    jv
    k0
    k1
    kn
    kolmogorov
    lanczos
    mtherr
    nbdtr
    ndtr
    ndtri
    pdtr
    psi
    rgamma
    round
    scipy_iv
    shichi
    sici
    sincos
    sindg
    spence
    stdtr
    struve
    tandg
    tukey
    unity
    yn
    zeta
    zetac
  ))
  (c_flags (
    -g -O3 -Ofast
    ; Experimental switches
    ; -ffast-math may break IEEE754 semantics
    -march=native -mfpmath=sse -funroll-loops -ffast-math -flto
    ; For Mersenne Twister RNG
    -DSFMT_MEXP=19937 -msse2 -fno-strict-aliasing
    ;  Turn off the warning on logical op parentheses
    -Wno-logical-op-parentheses
    ; For development use before release
    ; -Wall -pedantic -Wextra -Wunused
  ))
  (c_library_flags (
    -L/usr/local/lib/gcc/7
    -L/usr/local/opt/openblas/lib
    -lopenblas
    -lgfortran
    -lm
  ))
  (flags (:standard -safe-string))
  (libraries (
    ctypes
    ctypes.stubs
    gsl
    eigen
    plplot
  ))
))
